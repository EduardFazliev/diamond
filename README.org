[[https://github.com/BrightcoveOS/Diamond][Diamond]] Diamond is a python daemon that collects system metrics and publishes them to Graphite. It is capable of collecting cpu, memory, network, i/o, load and disk metrics. Additionally, it features an API for implementing custom collectors for gathering metrics from almost any source.

This cookbook aims to make the deployment of Diamond an open ended box that you can tie together however you see fit.  Simple example of installing diamond and configuring it with nothing but graphite.

#+BEGIN_CODE ruby
diamond_install "#{node['hostname']}" do  
  action :git  
end  
diamond_configure "#{node['hostname']}" do  
  action :config  
  diamond_handlers [ "diamond.handler.archive.ArchiveHandler", "diamond.handler.graphite.GraphiteHandler" ]  
  graphite_handler({"host" => "127.0.0.1","port" => 2003, "timeout" => 15})  
end  
#+END_CODE

Enabling plugins is not very difficult, due to the nature of how Diamond makes those we try to be kind :)

#+BEGIN_CODE ruby
diamond_plugin "CPUCollector" do 
  action :enable  
  options({})
end
diamond_plugin "PingCollector" do
  action :enable
  options({
            "enabled" => "True",
            "bin" => "/bin/ping",
            "use_sudo" => "False",
            "sudo_cmd" => "/usr/bin/sudo",
            "target_1" => "google.com",
            "target_2" => "aol.com"
          })  
end  
#+END_CODE


Author:: Scott M. Likens (<scott@likens.us>)

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.


